<style>
			.fontColor{background:white;color:black;height: 25px;width: 110px;padding-left: 12px;padding-top: 5px;}
			.greenColor{background:#009966;color:white;;height: 25px;width: 110px;padding-left: 12px;padding-top: 5px;}
		</style>
		<script type="text/javascript">
		$(document).ready(function(){
			var G = new AjaxFun();

			var excel = new ExportExcel();
			excel.url = "/ams/export/ReportWork";
			excel.exportTo();

			var DrownBox = new DropDownBox()//获取三级下拉框
			DrownBox.select = {"Team":"#team"};

			var data = {ID:"1",Type:"1", All:"1"};
			var url = "/ams/Info/TeamList";
			G.GetAjax('get',url,data,DrownBox.SetAllSelect,true);

			
			var value;
			$("button").click(function(){
				var SearchUrl = "/ams/ReportSearch/Work";
				var data = $("form:eq(0)").serialize();
				excel.Todata = data;
				//data = data+"&Page="+Page+"&PageSize="+PageSize;

				G.GetAjax('get',SearchUrl,data,ShowTable,true);
	
			})

			function ShowTable(v)
			{	
				if (v.user.length == 0){
					$("#table1 div").remove();
					$("#tip").css("display","block");
                    $(".TableCss div:lt(3)").remove();
					return;
				}
				showTitle(".TableCss div:eq(0)");

				value = v;
				//console.log(v);
				var headmodel = Array("Phone", "Notify", "Cut", "Reset", "Charge", "Customer");
				var headarray = Array( "电话催费", "通知单催费","停电","复电","回收电费","目前欠费");
				var s = value.team;

				SetGroupTable(s, headmodel, headarray);
			
			}

			function showTitle()
			{
				$(".TableCss div:lt(3)").remove();
				
				SetTitle("抄表员");
				SetTitle("班组情况");
				$(".TableCss div:eq(0)").addClass("greenColor");
				$(".TableCss div:eq(1)").addClass("fontColor");
			}

			function SetTitle(title)
			{
				var tpl = '<div   class="line fontColor" style="font-size:15px;margin-left:10px;float:left;cursor:pointer">'+title+'</div>';

				$(".TableCss").prepend(tpl);
			}
			function SetGroupTable(value, headmodel, headarray)
			{	
				$("#table1 div").remove();
				var headtpl = "";
				var tbodycontent = "";
				var table = '<div><table id="info"  >'+
				    '<thead><tr ><th >班组</th><th>欠费年月</th><th>项目</th>';

		    	 for (var i in headarray) {
		    	 	headtpl +=  '<th >'+headarray[i]+'</th>';
		    	 }

			    headtpl +='</thead><tbody>';
			    for (i in value) {
			    	var count = value[i].Count;
			    	var money = value[i].Money;
			    	tbodycontent += '<tr ><td rowspan="2" style="text-align:center;">'+i+'</td><td rowspan="2" style="text-align:center;">20140712</td><td style="text-align:center;">笔数</td>';
			    	for (var i in headmodel) {
			    		tbodycontent += '<td style="text-align:center;">'+count[headmodel[i]]+'</td>';
			    	}
			    	tbodycontent += '</tr><tr><td style="text-align:center;">金额</td>';

			    	for (var i in headmodel) {
			    		tbodycontent += '<td style="text-align:center;">'+money[headmodel[i]]+'</td>';
			    	}
			    	tbodycontent += '</tr>';
			    }
				 tbodycontent +='<tr>'+
				        '<td colspan="9" style="text-align:left" ><form name="excelform" id="excelform" method="post" target="put_excel" >&nbsp;&nbsp;&nbsp;&nbsp;导出文件：&nbsp;&nbsp;<span  id="excel" style="cursor:pointer"><img  src="/ams/public/images/Excel.png" style="height:25px;width:25px"/>&nbsp;EXCEL</span>&nbsp;&nbsp;</form></td>'+
				           ' </tr></tbody></table></div>';

			    var tpl = table + headtpl + tbodycontent;
			    $("#table1").append(tpl);
			    $("#table1 table tr:odd").addClass("InfoTr");
			    $("#table1 table tr:eq(1)").removeClass("InfoTr");
			}

			function SetUserTable(value, headmodel, headarray)
			{	
				$("#table1 div").remove();
				var headtpl = "";
				var tbodycontent = "";
				var table = '<div><table id="info"  >'+
				    '<thead><tr ><th >班组</th><th>欠费年月</th><th>抄表员</th><th>项目</th>';

		    	 for (var i in headarray) {
		    	 	headtpl +=  '<th >'+headarray[i]+'</th>';
		    	 }

			    headtpl +='</thead><tbody>';
			    for (i in value) {
			    	var source = value[i]
			    	var sourceNum = 0;
			    	for (var s in source) {
			    		sourceNum++;
			    	}

			    	tbodycontent += '<tr ><td rowspan="'+sourceNum*2+'" style="text-align:center;">'+i+'</td><td rowspan="'+sourceNum*2+'" style="text-align:center;">20140712</td>';
			    	for (var i in source) {
			    		var count = source[i].Count;
				    	var money = source[i].Money;
				    	tbodycontent += '<td  rowspan="2" style="text-align:center;">'+i+'</td><td  style="text-align:center;">笔数</td>';
				    	for (var i in headmodel) {
				    		if (count[headmodel[i]]) {
				    			var text = count[headmodel[i]];
				    		} else {
				    			text ="";
				    		}
				    		tbodycontent += '<td   style="text-align:center;">'+text+'</td>';
				    	}

				    	tbodycontent += '</tr><tr><td   style="text-align:center;">金额</td>';
                        for (var i in headmodel) {
				    		if (money[headmodel[i]]) {
				    			var text = money[headmodel[i]];
				    		} else {
				    			text ="";
				    		}
				    		tbodycontent += '<td  style="text-align:center;">'+text+'</td>';
				    	}
                        tbodycontent += '</tr>';
			    	}
			    }
				 tbodycontent +='<tr>'+
				        '<td colspan="10" style="text-align:left" ><form name="excelform" id="excelform" method="post" target="put_excel" >&nbsp;&nbsp;&nbsp;&nbsp;导出文件：&nbsp;&nbsp;<span  id="excel" style="cursor:pointer"><img  src="/ams/public/images/Excel.png" style="height:25px;width:25px"/></span>&nbsp;&nbsp;</form></td>'+
				           ' </tr></tbody></table></div>';
			
			    var tpl = table + headtpl + tbodycontent;
			    $("#table1").append(tpl);
			    $("#tip").css("display","none")
			}
			

			$(".TableCss").on("click"," div:eq(0)",function(v,s){
				$(".greenColor").removeClass("greenColor");
				$(".TableCss div:eq(0)").addClass("greenColor");
				$("#table1 div").remove();
				ShowTable(value);
			})

			$(".TableCss").on("click"," div:eq(1)",function(v,s){
				showTitle();
				$(".greenColor").removeClass("greenColor");
				$(".TableCss div:eq(1)").addClass("greenColor");
				$("#table1 div").remove();
				var headmodel = Array("Phone", "Notify", "Cut", "Reset", "Charge", "Customer");
				var headarray = Array( "电话催费", "通知单催费","停电","复电","回收电费","目前欠费");
				var v = value.user;
				SetUserTable(v, headmodel, headarray);
			})
		})
		</script>
		<link rel="stylesheet" href="/ams/css/jquery-ui.css">
		<script src="/ams/js/jquery-ui.js"></script>
		<script src="/ams/js/jquery-ui-date.js"></script>
		    <br />
		    <form>
		    <div class="line ClientInfo" >查询条件</div>
		    <div style="border:1px solid #009966;height:123px">
			    <div class=" mt_20" style="width:100%;height:25px;margin-top:15px">
			    	<div class=" InputStyle" style="margin-left:10px;float:left;margin-top:3px;*margin-top:6px">管理班组：</div>
				    <div id="team" class=" TreeInput" style="margin-left:5px;float:left">
				    </div>
				</div>
				<div class=" mt_20" style="width:100%;height:25px">
			    	<div class=" InputStyle" style="margin-left:10px;float:left;margin-top:3px;*margin-top:5px">工作时间：</div>
				    <div  style="margin-left:5px;float:left;width:400px;*margin-left:2px">
				        <input name="FromData" type="text" style="width:117px" id="day"/>&nbsp;&nbsp;至&nbsp;&nbsp;<input name="ToData" type="text" style="width:117px" id="ToDay" />
				    </div>
				</div>
				<button type="button"class="btn btn-success" style="background-color:#009966;margin-left:95px;margin-top:10px"  >查询</button>
			</div>
			<div id="tip" style="color:red;margin-left:12px;margin-top:4px;display:none">
				当前查询没有数据
			</div>
			</form>
		    <div  id="Arrears"  class="TableCss">
		    	<span id="table1">
			    </span>
		    </div>
			<br/><br/><br/><br/>