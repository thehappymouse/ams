<script>
Ext.onReady(function(){
    /*三个动态框*/
    var teamCombox = new SettCombbox({
        url:'/ams/Info/TeamList',
        fieldLabel: '管理班组',
        anchor:'95%',
        id:'team',
        hiddenName:'Team',
        autoLoad:true
    });

    var infoSearch = new Ext.FormPanel({
        title: '查询条件',
        defaults:{
            border: false
        },
        labelAlign: 'right',
        style: 'padding-top:10px',
        url:'/ams/Charges/SearchFee',
        layout:'column',
        items: [{
            columnWidth:.25,
            layout: 'form',
            defaults:{
                xtype: 'textfield'
            },
            items: [
                teamCombox]
        },{
            columnWidth:.25,
            layout: 'form',
            defaults:{
                xtype: 'textfield'
            },
            items: [
                {
                    xtype: 'compositefield',
                    fieldLabel: '电费年月',
                    defaults:{
                        xtype: 'datefield'
                    },
                    items:[
                        new Ext.form.DateField({
                            renderTo: document.body,
                            plugins:'monthPickerPlugin',
                            name:'FromData',
                            value:new Date().format('Ym')-4,
                            width:82,
                            format: 'Ym'
                        }),{
                            xtype: 'displayfield',
                            //   style: 'text-align:right;width:40px;',
                            value: '至: '
                        },new Ext.form.DateField({
                            renderTo: document.body,
                            plugins:'monthPickerPlugin',
                            name:'ToData',
                            width:82,
                            value:new Date().format('Ym'),
                            format: 'Ym'
                        })]
                }
            ]
        },{
            columnWidth:.25,
            layout: 'form',
            items:[{
                width:100,
                xtype:'button',
                text:'查询',
                handler:function(){
                }
            }]
        }]
    });
    var searchPanel = new Ext.TabPanel({
        labelWidth: 85,
        activeTab: 0,
        height:70,
        plain:true,
        defaults:{autoScroll: true},
        items:[
            infoSearch
        ]
    });

    var structure = {
        as: ['nanjing'],
        Asia: ['Beijing', 'Tokyo','Paris'],
        Europe: ['Berlin', 'London', 'Paris']
    },
    products = ['ProductX', 'ProductY'],
    fields = [],
    columns = [],
    data = [],
    continentGroupRow = [],
    cityGroupRow = [];


    /*
     * Example method that generates:
     * 1) The column configuration for the grid
     * 2) The column grouping configuration
     * 3) The data for the store
     * 4) The fields for the store
     */
    function generateConfig(){
        var arr,
        numProducts = products.length;

        Ext.iterate(structure, function(continent, cities){
            continentGroupRow.push({
                header: continent,
                align: 'center',
                colspan: cities.length * numProducts
            });
            Ext.each(cities, function(city){
                cityGroupRow.push({
                    header: city,
                    colspan: numProducts,
                    align: 'center'
                });
                Ext.each(products, function(product){
                    fields.push({
                        type: 'int',
                        name: city + product
                    });
                    columns.push({
                        dataIndex: city + product,
                        header: product,
                        renderer: Ext.util.Format.usMoney
                    });
                });
                arr = [];
                for(var i = 0; i < 20; ++i){
                    arr.push((Math.floor(Math.random()*11) + 1) * 100000);
                }
                data.push(arr);
            });
        })
    }

    // Run method to generate columns, fields, row grouping
    generateConfig();

    var group = new Ext.ux.grid.ColumnHeaderGroup({
        rows: [continentGroupRow, cityGroupRow]
    });

    var grid = new Ext.grid.GridPanel({
        title: 'Sales By Location',
        width: 1000,
        height: 400,
        store: new Ext.data.ArrayStore({
            fields: fields,
            data: data
        }),
        columns: [
            {dataIndex: 'BeijingProductX', header: 'ProductX'},
            {dataIndex: 'BeijingProductY', header: 'ProductY'},
            {dataIndex: 'TokyoProductX', header: 'ProductX'},
            {dataIndex: 'TokyoProductY', header: 'ProductY'},
            {dataIndex: 'BerlinProductX', header: 'ProductX'},
            {dataIndex: 'BerlinProductY', header: 'ProductY'},
            {dataIndex: 'LondonProductX', header: 'ProductX'},
            {dataIndex: 'LondonProductY', header: 'ProductY'},
            {dataIndex: 'ParisProductX', header: 'ProductX'},
            {dataIndex: 'ParisProductY', header: 'ProductY'}
        ],
        plugins: group
    });

    var infoTab = new Ext.TabPanel({
        labelWidth: 85,
        activeTab: 0,
        height:70,
        plain:true,
        style: 'margin-top:15px',
        defaults:{autoScroll: true},
        items:[
            grid
        ]
    });
    var allPanel = new Ext.Panel({
        region: 'center',
        fileUpload: true,
        autoScroll: true,
        bodyStyle: "padding:20px;",
        items: [
            searchPanel,
            infoTab
        ]
    });
    new Ext.Viewport(
            {
                layout: 'border',
                items: [
                    allPanel
                ]
            });
})
 </script>