<style>
			.fontColor{background:white;color:black;height: 25px;width: 110px;padding-left: 12px;padding-top: 5px;}
			.greenColor{background:#009966;color:white;;height: 25px;width: 110px;padding-left: 12px;padding-top: 5px;}
		</style>

		<script type="text/javascript" src="/ams/js/jquery.jqprint-0.3.js" ></script>

		<script type="text/javascript">
		$(document).ready(function(){
			var G = new AjaxFun();

			var excel = new ExportExcel();
			excel.url = "/ams/export/ReportPress";
			excel.exportTo();

			
			var DrownBox = new DropDownBox()//获取三级下拉框
			DrownBox.select = {"Team":"#team"};

			var data = {ID:"1",Type:"1", All:"1"};
			var url = "/ams/Info/TeamList";
			G.GetAjax('get',url,data,DrownBox.SetAllSelect,true);


			var value;
			$("button").click(function(){
				var SearchUrl = "/ams/ReportSearch/press";
				var data = $("form:eq(0)").serialize();
				excel.Todata = data;
				//data = data+"&Page="+Page+"&PageSize="+PageSize;

				G.GetAjax('get',SearchUrl,data,ShowTable,true);
	
			})

			function ShowTable(v)
			{	
				if (v.years.length == 0){
					$("#table1 div").remove();
					$("#tip").css("display","block");
                    $(".TableCss div:lt(3)").remove();
					return;
				}
				showTitle();

				value = v;
				var headmodel = Array("Rate", "NoPressCount", "NoPressMoney");
				var headarray = Array( "催费完成率", "未催费户数","未催费金额");
				var v = value.userdata;
				var year = value.years;
				SetTable(v, year, headmodel, headarray,false);
			
			}

			function showTitle()
			{
				$(".TableCss div:lt(3)").remove();
				
				SetTitle("班组情况");
				SetTitle("抄表员");
				$(".TableCss div:eq(0)").addClass("greenColor");
				$(".TableCss div:eq(1)").addClass("fontColor");
			}

			function SetTitle(title)
			{
				var tpl = '<div   class="line fontColor" style="font-size:15px;margin-left:10px;float:left;cursor:pointer">'+title+'</div>';

				$(".TableCss").prepend(tpl);
			}
			function SetTable(value, year, headmodel, headarray, th)
			{	
				$("#table1 div").remove();
				
				var headtpl = "";
				var tbodyheadmodel = "";
				var tbodycontent = "";
				var data;
				var people;

				var width = (value.length*3+1)*85;
				if (width < 940) {
					width = '940px';
				}  else {
					width += 'px'; 

				}
                stylecss = '<div style="width:940px;overflow:scroll;overflow-y:hidden">';
				if (th) {
					people="班组";
				} else {
					people="抄表员";
				}
				var table = stylecss+'<table id="info" style="width:'+width+'" >'+
				    '<thead><tr ><th >'+people+'</th>';

		    	 for (var i in value) {
		    	 	headtpl +=  '<th colspan="3">'+value[i].Name+'</th>';
		    	 }
			    headtpl +='</tr></thead><tbody><tr><td style="color:#009966;font-weight:bold;text-align:center">欠费年月</td>';
				      
				     for (var i in value) {
				    
				     	for (var i=0; i<3; i++) {

				     		tbodyheadmodel += '<td style="color:#009966;font-weight:bold;text-align:center">'+headarray[i]+'</td>';
				     	}
		     			
				     }
					tbodyheadmodel +='</tr>';

					for (var i in year) {
						   	yeardata = year[i];
					   		tbodycontent += '<tr ><td style="text-align:center">'+yeardata+'</td>'
				   		for (var i in value) {
								data = value[i].Data;
								
							if (data[yeardata] != undefined) {
						   		contentdata = data[yeardata]

						   		for (var i in headmodel) {
						   			

						   			tbodycontent  += '<td style="text-align:center">'+contentdata[headmodel[i]]+'</td>';
						   		}
						   } else {
						   		for (var i in headmodel) {
						   			tbodycontent  += '<td></td>';
						   		}
						   }
							   
								
						}
					   	
					   tbodycontent += '</tr>'
					}

				    
				       var tbodyend =  '<tr><td style="color:#009966;font-weight:bold;text-align:center">汇总</td>';
				           for (var i in value) {
				           		var all = value[i].AllData;
				           		var n = 0;
				           		if (all) {
				           			for (var i in all) {
					           			if (headmodel[n]) {
											tbodyend +=  '<td style="text-align:center" >'+all[headmodel[n]]+'</td>';
					           			
										}
										n++;
					           			
					           		}
				           		} else {
				           			for (var i = 0; i<3; i++) {
				           				tbodyend +=  '<td style="text-align:center" ></td>';
				           			}
				           		}
				           		
				           	
				           } 
				        
				           
				        tbodyend += '</tr>'+
				        '<tr >'+
				            '<td style="color:#009966;font-weight:bold;text-align:center">排名</td>';

				            for ( i in value) {
				            	i++;
				            	tbodyend += '<td colspan="3" style="color:#009966;font-weight:bold;text-align:center">'+i+'</td>';
				            }
				            
				          
				        tbodyend +='</tr>'+
				            '<tr>'+
				        '<td colspan="'+parseInt(i*3+1)+'" style="text-align:left" ><form name="excelform" id="excelform" method="post" target="put_excel" >&nbsp;&nbsp;&nbsp;&nbsp;导出文件：&nbsp;&nbsp;<span  id="excel" style="cursor:pointer"><img  src="/ams/public/images/Excel.png" style="height:25px;width:25px"/></span>&nbsp;&nbsp;</form></td>'+
				           ' </tr>';
				    var end = '</tbody>'+
			    '</table></div>';
			    var tpl = table+headtpl+tbodyheadmodel+tbodycontent+tbodyend+end;
			    
			    $("#table1").append(tpl);
			    $("#table1 table tr:odd").addClass("InfoTr");
			    $("#table1 table tr:eq(1)").removeClass("InfoTr");
			    
			    $("#tip").css("display","none");
			    //console.log(tpl);
			}
			

			$(".TableCss").on("click","div:eq(0)",function(v,s){

				$(".greenColor").removeClass("greenColor");
				$(".TableCss div:eq(0)").addClass("greenColor");

				$("#table1 div").remove();
				ShowTable(value);
				
				//$("#table1").append(table);
			})

			$(".TableCss").on("click","div:eq(1)",function(v,s){
				$("#table1 div").remove();
				showTitle();
				$(".greenColor").removeClass("greenColor");
				$(".TableCss div:eq(1)").addClass("greenColor");
				
				


				var headmodel = Array("Rate", "NoPressCount", "NoPressMoney");
				var headarray = Array( "催费完成率", "未催费户数","未催费金额");
				var v = value.result;
				var year = value.years;
				SetTable(v, year, headmodel, headarray,true);
				
			})

		
			
			
		})
		</script>
	


		<link rel="stylesheet" href="/ams/css/jquery-ui.css">
		<script src="/ams/js/jquery-ui.js"></script>
		<script src="/ams/js/jquery-ui-date.js"></script>


		<br />
		<form>
		    <div class="line ClientInfo" >查询条件</div>
		    <div style="border:1px solid #009966;height:123px">
			    <div class=" mt_20" style="width:100%;height:25px;margin-top:15px">
			    
			    	<div class=" InputStyle" style="margin-left:10px;float:left;margin-top:3px;*margin-top:6px">管理班组：</div>
				    <div id="team" class=" TreeInput" style="margin-left:5px;float:left">
				       
				    </div>
				
				
				</div>
				<div class=" mt_20" style="width:100%;height:25px">

			    	<div class=" InputStyle" style="margin-left:10px;float:left;margin-top:3px;*margin-top:5px">电费年月：</div>
				    <div  style="margin-left:5px;float:left;width:400px;*margin-left:2px">
				        <input name="Fromdata" type="text"  style="width:117px" id="from" />&nbsp;&nbsp;至&nbsp;&nbsp;<input name="Todata" style="width:117px" type="text" id="to" />
				    </div>
				
					
				
				</div>
				<button type="button" class="btn btn-success" style="background-color:#009966;margin-left:95px;margin-top:10px"  >查询</button>
			</div>
			<div id="tip" style="color:red;margin-left:12px;margin-top:4px;display:none">
				当前查询没有数据
			</div>
		</form>
		
		    
		    <div id="Arrears" class="TableCss">
		    	
		    
		    	<span id="table1">
			    </span>

		    </div>	
		    <br/><br/><br/><br/>

		    		